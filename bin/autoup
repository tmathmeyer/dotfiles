#!/bin/sh
SSHKEY=$HOME/.ssh/id_rsa
SERVER=tmathmeyer.me
WEBROOT=/var/www
WEBDIR=files
USER=ted

test -z "$1" && exit 1 || FILENAME=$(basename $1)
mv $1 /tmp/$FILENAME
FILE="/tmp/$FILENAME"
chmod 644 $FILE
scp -i "$SSHKEY" "$FILE" "${USER}@${SERVER}:${WEBROOT}/${WEBDIR}/$FILENAME"
echo "http://$WEBDIR.$SERVER/$FILENAME" | xclip
if [ "$2" != "silent" ]; then
    notify-send "$FILENAME uploaded!"
fi
